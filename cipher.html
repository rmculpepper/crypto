<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"/><meta name="viewport" content="width=device-width, initial-scale=0.8"/><title>4&nbsp;Symmetric Encryption</title><link rel="stylesheet" type="text/css" href="scribble.css" title="default"/><link rel="stylesheet" type="text/css" href="racket.css" title="default"/><link rel="stylesheet" type="text/css" href="manual-style.css" title="default"/><link rel="stylesheet" type="text/css" href="manual-racket.css" title="default"/><script type="text/javascript" src="scribble-common.js"></script><script type="text/javascript" src="manual-racket.js"></script><!--[if IE 6]><style type="text/css">.SIEHidden { overflow: hidden; }</style><![endif]--></head><body id="scribble-racket-lang-org"><div class="tocset"><div class="tocview"><div class="tocviewlist tocviewlisttopspace"><div class="tocviewtitle"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_0&quot;);">&#9660;</a></td><td></td><td><a href="index.html" class="tocviewlink" data-pltdoc="x">Crypto:<span class="mywbr"> &nbsp;</span> Cryptographic Operations</a></td></tr></table></div><div class="tocviewsublisttop" style="display: block;" id="tocview_0"><table cellspacing="0" cellpadding="0"><tr><td align="right">1&nbsp;</td><td><a href="intro.html" class="tocviewlink" data-pltdoc="x">Introduction to the Crypto Library</a></td></tr><tr><td align="right">2&nbsp;</td><td><a href="factory.html" class="tocviewlink" data-pltdoc="x">Cryptography Factories</a></td></tr><tr><td align="right">3&nbsp;</td><td><a href="digest.html" class="tocviewlink" data-pltdoc="x">Message Digests</a></td></tr><tr><td align="right">4&nbsp;</td><td><a href="" class="tocviewselflink" data-pltdoc="x">Symmetric Encryption</a></td></tr><tr><td align="right">5&nbsp;</td><td><a href="pk.html" class="tocviewlink" data-pltdoc="x">Public-<wbr></wbr>Key Cryptography</a></td></tr><tr><td align="right">6&nbsp;</td><td><a href="kdf.html" class="tocviewlink" data-pltdoc="x">Key Derivation and Password Hashing</a></td></tr><tr><td align="right">7&nbsp;</td><td><a href="misc.html" class="tocviewlink" data-pltdoc="x">Miscellaneous Notes and Utilities</a></td></tr></table></div></div><div class="tocviewlist"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_1&quot;);">&#9658;</a></td><td>4&nbsp;</td><td><a href="" class="tocviewselflink" data-pltdoc="x">Symmetric Encryption</a></td></tr></table><div class="tocviewsublistbottom" style="display: none;" id="tocview_1"><table cellspacing="0" cellpadding="0"><tr><td align="right">4.1&nbsp;</td><td><a href="#%28part._.High-level_.Cipher_.Operations%29" class="tocviewlink" data-pltdoc="x">High-<wbr></wbr>level Cipher Operations</a></td></tr><tr><td align="right">4.2&nbsp;</td><td><a href="#%28part._.Low-level_.Cipher_.Operations%29" class="tocviewlink" data-pltdoc="x">Low-<wbr></wbr>level Cipher Operations</a></td></tr></table></div></div></div><div class="tocsub"><div class="tocsubtitle">On this page:</div><table class="tocsublist" cellspacing="0"><tr><td><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._cipher-spec~3f%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">cipher-<wbr></wbr>spec?</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._cipher-impl~3f%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">cipher-<wbr></wbr>impl?</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._get-cipher%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">get-<wbr></wbr>cipher</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._cipher-block-size%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">cipher-<wbr></wbr>block-<wbr></wbr>size</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._cipher-default-key-size%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">cipher-<wbr></wbr>default-<wbr></wbr>key-<wbr></wbr>size</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._cipher-key-sizes%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">cipher-<wbr></wbr>key-<wbr></wbr>sizes</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._cipher-iv-size%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">cipher-<wbr></wbr>iv-<wbr></wbr>size</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._cipher-aead~3f%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">cipher-<wbr></wbr>aead?</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._cipher-default-auth-size%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">cipher-<wbr></wbr>default-<wbr></wbr>auth-<wbr></wbr>size</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._generate-cipher-key%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">generate-<wbr></wbr>cipher-<wbr></wbr>key</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._generate-cipher-iv%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">generate-<wbr></wbr>cipher-<wbr></wbr>iv</span></span></a></td></tr><tr><td><span class="tocsublinknumber">4.1<tt>&nbsp;</tt></span><a href="#%28part._.High-level_.Cipher_.Operations%29" class="tocsubseclink" data-pltdoc="x">High-<wbr></wbr>level Cipher Operations</a></td></tr><tr><td><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._encrypt%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">encrypt</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._decrypt%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">decrypt</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._encrypt%2Fauth%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">encrypt/<span class="mywbr"> &nbsp;</span>auth</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._decrypt%2Fauth%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">decrypt/<span class="mywbr"> &nbsp;</span>auth</span></span></a></td></tr><tr><td><span class="tocsublinknumber">4.2<tt>&nbsp;</tt></span><a href="#%28part._.Low-level_.Cipher_.Operations%29" class="tocsubseclink" data-pltdoc="x">Low-<wbr></wbr>level Cipher Operations</a></td></tr><tr><td><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._make-encrypt-ctx%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">make-<wbr></wbr>encrypt-<wbr></wbr>ctx</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._make-decrypt-ctx%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">make-<wbr></wbr>decrypt-<wbr></wbr>ctx</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._cipher-ctx~3f%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">cipher-<wbr></wbr>ctx?</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._encrypt-ctx~3f%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">encrypt-<wbr></wbr>ctx?</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._decrypt-ctx~3f%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">decrypt-<wbr></wbr>ctx?</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._cipher-update%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">cipher-<wbr></wbr>update</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._cipher-update-aad%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">cipher-<wbr></wbr>update-<wbr></wbr>aad</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._cipher-final%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">cipher-<wbr></wbr>final</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._cipher-get-auth-tag%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">cipher-<wbr></wbr>get-<wbr></wbr>auth-<wbr></wbr>tag</span></span></a></td></tr></table></div></div><div class="maincolumn"><div class="main"><div class="navsettop"><span class="navleft"><div class="nosearchform"></div>&nbsp;&nbsp;</span><span class="navright">&nbsp;&nbsp;<a href="digest.html" title="backward to &quot;3 Message Digests&quot;" data-pltdoc="x">&larr; prev</a>&nbsp;&nbsp;<a href="index.html" title="up to &quot;Crypto: Cryptographic Operations&quot;" data-pltdoc="x">up</a>&nbsp;&nbsp;<a href="pk.html" title="forward to &quot;5 Public-Key Cryptography&quot;" data-pltdoc="x">next &rarr;</a></span>&nbsp;</div><h3>4<tt>&nbsp;</tt><a name="(part._cipher)"></a>Symmetric Encryption</h3><p>A cipher (or symmetric-key encryption algorithm) is a reversable
function from variable-length messages to messages. The input is
called the &ldquo;plaintext&rdquo; and the output is called the &ldquo;ciphertext.&rdquo;
For a good cipher, the ciphertext reveals no information about the
contents of the plaintext (only its length or approximate length); in
particular, it is infeasible to compute the plaintext corresponding to
a given ciphertext without knowing the secret key.</p><p>Ciphers are organized into families that share common encryption and
decryption algorithms but differ in parameters such as key length and
block mode. For example, the AES family supports key lengths of 128,
192, and 256 bits, and it supports a wide range of modes, including
ECB, CBC, and CTR.</p><p>This library provides both high-level, all-at-once encryption and
decryption operations and low-level, incremental operations.</p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._crypto/main..rkt)._cipher-spec~3f))"></a><span title="Provided from: crypto | Package: crypto-lib"><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._cipher-spec~3f%29%29" class="RktValDef RktValLink" data-pltdoc="x">cipher-spec?</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">v</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/booleans.html#%28def._%28%28quote._~23~25kernel%29._boolean~3f%29%29" class="RktValLink" data-pltdoc="x">boolean?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">v</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/data-structure-contracts.html#%28def._%28%28lib._racket%2Fcontract%2Fprivate%2Fmisc..rkt%29._any%2Fc%29%29" class="RktValLink" data-pltdoc="x">any/c</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Returns <span class="RktVal">#t</span> if <span class="RktVar">v</span> represents a cipher specifier,
<span class="RktVal">#f</span> otherwise.</div></p><p><div class="SIntrapara">A cipher specifier is one of the following:
</div><div class="SIntrapara"><ul><li><p><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/pairs.html#%28def._%28%28quote._~23~25kernel%29._list%29%29" class="RktValLink" data-pltdoc="x">list</a></span><span class="stt"> </span><span class="RktVar">stream-cipher</span><span class="stt"> </span><span class="RktVal">'</span><span class="RktVal">stream</span><span class="RktPn">)</span>&#8212;<wbr></wbr>where
<span class="RktVar">stream-cipher</span> is one of the following symbols:
<span class="RktVal">'</span><span class="RktVal">chacha20</span>, <span class="RktVal">'</span><span class="RktVal">chacha20-poly1305</span>, <span class="RktVal">'</span><span class="RktVal">chacha20-poly1305/iv8</span>, <span class="RktVal">'</span><span class="RktVal">rc4</span>, <span class="RktVal">'</span><span class="RktVal">salsa20</span>, <span class="RktVal">'</span><span class="RktVal">salsa20r12</span>, <span class="RktVal">'</span><span class="RktVal">salsa20r8</span>, <span class="RktVal">'</span><span class="RktVal">xchacha20-poly1305</span>.</p></li><li><p><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/pairs.html#%28def._%28%28quote._~23~25kernel%29._list%29%29" class="RktValLink" data-pltdoc="x">list</a></span><span class="stt"> </span><span class="RktVar">block-cipher</span><span class="stt"> </span><span class="RktVar">block-mode</span><span class="RktPn">)</span>&#8212;<wbr></wbr>where
<span class="RktVar">block-cipher</span> is one of the following symbols:
<span class="RktVal">'</span><span class="RktVal">aes</span>, <span class="RktVal">'</span><span class="RktVal">blowfish</span>, <span class="RktVal">'</span><span class="RktVal">camellia</span>, <span class="RktVal">'</span><span class="RktVal">cast128</span>, <span class="RktVal">'</span><span class="RktVal">des</span>, <span class="RktVal">'</span><span class="RktVal">des-ede2</span>, <span class="RktVal">'</span><span class="RktVal">des-ede3</span>, <span class="RktVal">'</span><span class="RktVal">idea</span>, <span class="RktVal">'</span><span class="RktVal">serpent</span>, <span class="RktVal">'</span><span class="RktVal">twofish</span>,
and <span class="RktVar">block-mode</span> is one of the following symbols:
<span class="RktVal">'</span><span class="RktVal">ecb</span>, <span class="RktVal">'</span><span class="RktVal">cbc</span>, <span class="RktVal">'</span><span class="RktVal">ofb</span>, <span class="RktVal">'</span><span class="RktVal">cfb</span>, <span class="RktVal">'</span><span class="RktVal">ctr</span>, <span class="RktVal">'</span><span class="RktVal">gcm</span>, <span class="RktVal">'</span><span class="RktVal">ocb</span>, <span class="RktVal">'</span><span class="RktVal">eax</span>.</p></li></ul></div></p><p>Note that the key length is not considered part of the cipher
specifier; it is determined implicitly from the key provided to
<span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._encrypt%29%29" class="RktValLink" data-pltdoc="x">encrypt</a></span>, <span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._make-encrypt-ctx%29%29" class="RktValLink" data-pltdoc="x">make-encrypt-ctx</a></span>, etc.</p><p>The CCM block mode is not supported because of its burdensome
requirements: it requires the message and AAD lengths to be known in
advance.</p><p>Future versions of this library may add more ciphers to the lists
above and other forms of cipher specifiers.</p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._crypto/main..rkt)._cipher-impl~3f))"></a><span title="Provided from: crypto | Package: crypto-lib"><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._cipher-impl~3f%29%29" class="RktValDef RktValLink" data-pltdoc="x">cipher-impl?</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">v</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/booleans.html#%28def._%28%28quote._~23~25kernel%29._boolean~3f%29%29" class="RktValLink" data-pltdoc="x">boolean?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">v</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/data-structure-contracts.html#%28def._%28%28lib._racket%2Fcontract%2Fprivate%2Fmisc..rkt%29._any%2Fc%29%29" class="RktValLink" data-pltdoc="x">any/c</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Returns <span class="RktVal">#t</span> if <span class="RktVar">v</span> represents a cipher implementation,
<span class="RktVal">#f</span> otherwise.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._crypto/main..rkt)._get-cipher))"></a><span title="Provided from: crypto | Package: crypto-lib"><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._get-cipher%29%29" class="RktValDef RktValLink" data-pltdoc="x">get-cipher</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">ci</span><span class="hspace">&nbsp;</span>[<span class="RktVar">factories</span>]<span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/data-structure-contracts.html#%28def._%28%28lib._racket%2Fcontract%2Fbase..rkt%29._or%2Fc%29%29" class="RktValLink" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._cipher-impl~3f%29%29" class="RktValLink" data-pltdoc="x">cipher-impl?</a></span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="RktPn">)</span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">ci</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._cipher-spec~3f%29%29" class="RktValLink" data-pltdoc="x">cipher-spec?</a></span></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="argcontract"><tr><td valign="top"><span class="hspace">&nbsp;&nbsp;</span></td><td valign="top"><span class="RktVar">factories</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top">:</td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/data-structure-contracts.html#%28def._%28%28lib._racket%2Fcontract%2Fbase..rkt%29._or%2Fc%29%29" class="RktValLink" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="factory.html#%28def._%28%28lib._crypto%2Fmain..rkt%29._crypto-factory~3f%29%29" class="RktValLink" data-pltdoc="x">crypto-factory?</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/data-structure-contracts.html#%28def._%28%28lib._racket%2Fcontract%2Fbase..rkt%29._listof%29%29" class="RktValLink" data-pltdoc="x">listof</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="factory.html#%28def._%28%28lib._crypto%2Fmain..rkt%29._crypto-factory~3f%29%29" class="RktValLink" data-pltdoc="x">crypto-factory?</a></span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top">=</td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">(</span><span class="RktSym"><a href="factory.html#%28def._%28%28lib._crypto%2Fmain..rkt%29._crypto-factories%29%29" class="RktValLink" data-pltdoc="x">crypto-factories</a></span><span class="RktPn">)</span></td></tr></table></td></tr></table></blockquote></div><div class="SIntrapara">Returns an implementation of cipher <span class="RktVar">ci</span> from the given
<span class="RktVar">factories</span>. If no factory in <span class="RktVar">factories</span> implements
<span class="RktVar">ci</span>, returns <span class="RktVal">#f</span>.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._crypto/main..rkt)._cipher-block-size))"></a><span title="Provided from: crypto | Package: crypto-lib"><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._cipher-block-size%29%29" class="RktValDef RktValLink" data-pltdoc="x">cipher-block-size</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">ci</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/number-types.html#%28def._%28%28quote._~23~25kernel%29._exact-positive-integer~3f%29%29" class="RktValLink" data-pltdoc="x">exact-positive-integer?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">ci</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/data-structure-contracts.html#%28def._%28%28lib._racket%2Fcontract%2Fbase..rkt%29._or%2Fc%29%29" class="RktValLink" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._cipher-spec~3f%29%29" class="RktValLink" data-pltdoc="x">cipher-spec?</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._cipher-impl~3f%29%29" class="RktValLink" data-pltdoc="x">cipher-impl?</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._cipher-ctx~3f%29%29" class="RktValLink" data-pltdoc="x">cipher-ctx?</a></span><span class="RktPn">)</span></td></tr></table></blockquote></div><div class="SIntrapara">Returns the size in bytes of the blocks manipulated by the cipher. If
<span class="RktVar">ci</span> is a stream cipher (including block ciphers using a stream
mode such as CTR), returns <span class="RktVal">1</span>.</div></p><p>A cipher produces a ciphertext that is a multiple of its block
size. If a cipher is used without padding, the plaintext must be a
multiple of the block size.</p><p><div class="SIntrapara">Examples:</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._cipher-block-size%29%29" class="RktValLink" data-pltdoc="x">cipher-block-size</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">aes</span><span class="hspace">&nbsp;</span><span class="RktVal">cbc</span><span class="RktVal">)</span><span class="RktPn">)</span></td></tr><tr><td><p><span class="RktRes">16</span></p></td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._cipher-block-size%29%29" class="RktValLink" data-pltdoc="x">cipher-block-size</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">aes</span><span class="hspace">&nbsp;</span><span class="RktVal">ctr</span><span class="RktVal">)</span><span class="RktPn">)</span></td></tr><tr><td><p><span class="RktRes">1</span></p></td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._cipher-block-size%29%29" class="RktValLink" data-pltdoc="x">cipher-block-size</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">salsa20</span><span class="hspace">&nbsp;</span><span class="RktVal">stream</span><span class="RktVal">)</span><span class="RktPn">)</span></td></tr><tr><td><p><span class="RktRes">1</span></p></td></tr></table></blockquote></div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._crypto/main..rkt)._cipher-default-key-size))"></a><span title="Provided from: crypto | Package: crypto-lib"><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._cipher-default-key-size%29%29" class="RktValDef RktValLink" data-pltdoc="x">cipher-default-key-size</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">ci</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/number-types.html#%28def._%28%28quote._~23~25kernel%29._exact-nonnegative-integer~3f%29%29" class="RktValLink" data-pltdoc="x">exact-nonnegative-integer?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">ci</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/data-structure-contracts.html#%28def._%28%28lib._racket%2Fcontract%2Fbase..rkt%29._or%2Fc%29%29" class="RktValLink" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._cipher-spec~3f%29%29" class="RktValLink" data-pltdoc="x">cipher-spec?</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._cipher-impl~3f%29%29" class="RktValLink" data-pltdoc="x">cipher-impl?</a></span><span class="RktPn">)</span></td></tr></table></blockquote></div><div class="SIntrapara">Returns a default size in bytes of the secret keys used by the cipher.</div></p><p><div class="SIntrapara">Examples:</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._cipher-default-key-size%29%29" class="RktValLink" data-pltdoc="x">cipher-default-key-size</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">aes</span><span class="hspace">&nbsp;</span><span class="RktVal">cbc</span><span class="RktVal">)</span><span class="RktPn">)</span></td></tr><tr><td><p><span class="RktRes">16</span></p></td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._cipher-default-key-size%29%29" class="RktValLink" data-pltdoc="x">cipher-default-key-size</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">chacha20</span><span class="hspace">&nbsp;</span><span class="RktVal">stream</span><span class="RktVal">)</span><span class="RktPn">)</span></td></tr><tr><td><p><span class="RktRes">32</span></p></td></tr></table></blockquote></div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._crypto/main..rkt)._cipher-key-sizes))"></a><span title="Provided from: crypto | Package: crypto-lib"><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._cipher-key-sizes%29%29" class="RktValDef RktValLink" data-pltdoc="x">cipher-key-sizes</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">ci</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/data-structure-contracts.html#%28def._%28%28lib._racket%2Fcontract%2Fbase..rkt%29._listof%29%29" class="RktValLink" data-pltdoc="x">listof</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/number-types.html#%28def._%28%28quote._~23~25kernel%29._exact-nonnegative-integer~3f%29%29" class="RktValLink" data-pltdoc="x">exact-nonnegative-integer?</a></span><span class="RktPn">)</span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">ci</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/data-structure-contracts.html#%28def._%28%28lib._racket%2Fcontract%2Fbase..rkt%29._or%2Fc%29%29" class="RktValLink" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._cipher-spec~3f%29%29" class="RktValLink" data-pltdoc="x">cipher-spec?</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._cipher-impl~3f%29%29" class="RktValLink" data-pltdoc="x">cipher-impl?</a></span><span class="RktPn">)</span></td></tr></table></blockquote></div><div class="SIntrapara">Returns the possible sizes in bytes of the secret keys used by the
cipher.</div></p><p><div class="SIntrapara">Examples:</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._cipher-key-sizes%29%29" class="RktValLink" data-pltdoc="x">cipher-key-sizes</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">aes</span><span class="hspace">&nbsp;</span><span class="RktVal">cbc</span><span class="RktVal">)</span><span class="RktPn">)</span></td></tr><tr><td><p><span class="RktRes">'(16 24 32)</span></p></td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._cipher-key-sizes%29%29" class="RktValLink" data-pltdoc="x">cipher-key-sizes</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">chacha20</span><span class="hspace">&nbsp;</span><span class="RktVal">stream</span><span class="RktVal">)</span><span class="RktPn">)</span></td></tr><tr><td><p><span class="RktRes">'(32)</span></p></td></tr></table></blockquote></div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._crypto/main..rkt)._cipher-iv-size))"></a><span title="Provided from: crypto | Package: crypto-lib"><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._cipher-iv-size%29%29" class="RktValDef RktValLink" data-pltdoc="x">cipher-iv-size</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">ci</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/number-types.html#%28def._%28%28quote._~23~25kernel%29._exact-nonnegative-integer~3f%29%29" class="RktValLink" data-pltdoc="x">exact-nonnegative-integer?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">ci</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/data-structure-contracts.html#%28def._%28%28lib._racket%2Fcontract%2Fbase..rkt%29._or%2Fc%29%29" class="RktValLink" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._cipher-spec~3f%29%29" class="RktValLink" data-pltdoc="x">cipher-spec?</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._cipher-impl~3f%29%29" class="RktValLink" data-pltdoc="x">cipher-impl?</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._cipher-ctx~3f%29%29" class="RktValLink" data-pltdoc="x">cipher-ctx?</a></span><span class="RktPn">)</span></td></tr></table></blockquote></div><div class="SIntrapara">Returns the size in bytes of the <a name="(tech._initialization._vector)"></a><span style="font-style: italic">initialization vector</span> (IV)
used by the cipher. Returns <span class="RktVal">0</span> if the cipher does not use an
IV.</div></p><p>This library uses a broad interpretation of the term &ldquo;IV&rdquo;. For
example, if <span class="RktVar">ci</span> is a block cipher in CTR mode, this function
returns the size of the counter.</p><p><div class="SIntrapara">Examples:</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._cipher-iv-size%29%29" class="RktValLink" data-pltdoc="x">cipher-iv-size</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">aes</span><span class="hspace">&nbsp;</span><span class="RktVal">cbc</span><span class="RktVal">)</span><span class="RktPn">)</span></td></tr><tr><td><p><span class="RktRes">16</span></p></td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._cipher-iv-size%29%29" class="RktValLink" data-pltdoc="x">cipher-iv-size</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">aes</span><span class="hspace">&nbsp;</span><span class="RktVal">ctr</span><span class="RktVal">)</span><span class="RktPn">)</span></td></tr><tr><td><p><span class="RktRes">16</span></p></td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._cipher-iv-size%29%29" class="RktValLink" data-pltdoc="x">cipher-iv-size</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">aes</span><span class="hspace">&nbsp;</span><span class="RktVal">gcm</span><span class="RktVal">)</span><span class="RktPn">)</span></td></tr><tr><td><p><span class="RktRes">12</span></p></td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._cipher-iv-size%29%29" class="RktValLink" data-pltdoc="x">cipher-iv-size</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">aes</span><span class="hspace">&nbsp;</span><span class="RktVal">ecb</span><span class="RktVal">)</span><span class="RktPn">)</span></td></tr><tr><td><p><span class="RktRes">0</span></p></td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._cipher-iv-size%29%29" class="RktValLink" data-pltdoc="x">cipher-iv-size</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">chacha20-poly1305</span><span class="hspace">&nbsp;</span><span class="RktVal">stream</span><span class="RktVal">)</span><span class="RktPn">)</span></td></tr><tr><td><p><span class="RktRes">12</span></p></td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._cipher-iv-size%29%29" class="RktValLink" data-pltdoc="x">cipher-iv-size</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">chacha20-poly1305/iv8</span><span class="hspace">&nbsp;</span><span class="RktVal">stream</span><span class="RktVal">)</span><span class="RktPn">)</span></td></tr><tr><td><p><span class="RktRes">8</span></p></td></tr></table></blockquote></div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._crypto/main..rkt)._cipher-aead~3f))"></a><span title="Provided from: crypto | Package: crypto-lib"><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._cipher-aead~3f%29%29" class="RktValDef RktValLink" data-pltdoc="x">cipher-aead?</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">ci</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/booleans.html#%28def._%28%28quote._~23~25kernel%29._boolean~3f%29%29" class="RktValLink" data-pltdoc="x">boolean?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">ci</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/data-structure-contracts.html#%28def._%28%28lib._racket%2Fcontract%2Fbase..rkt%29._or%2Fc%29%29" class="RktValLink" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._cipher-spec~3f%29%29" class="RktValLink" data-pltdoc="x">cipher-spec?</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._cipher-impl~3f%29%29" class="RktValLink" data-pltdoc="x">cipher-impl?</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._cipher-ctx~3f%29%29" class="RktValLink" data-pltdoc="x">cipher-ctx?</a></span><span class="RktPn">)</span></td></tr></table></blockquote></div><div class="SIntrapara">Returns <span class="RktVal">#t</span> if <span class="RktVar">ci</span> is an <a href="#%28tech._authenticated._encryption%29" class="techoutside" data-pltdoc="x"><span class="techinside">authenticated
encryption</span></a> cipher, <span class="RktVal">#f</span> otherwise. See <span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._encrypt%29%29" class="RktValLink" data-pltdoc="x">encrypt</a></span>
for more details.</div></p><p>An <a name="(tech._authenticated._encryption)"></a><span style="font-style: italic">authenticated encryption</span> cipher (with <span style="font-style: italic">additionally
authenticated data</span>, AEAD) produces an <a name="(tech._authentication._tag)"></a><span style="font-style: italic">authentication tag</span> in
addition to the ciphertext. An AEAD cipher provides both
confidentiality and integrity, whereas a non-AEAD cipher only provides
confidentiality.</p><p><div class="SIntrapara">Examples:</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._cipher-aead~3f%29%29" class="RktValLink" data-pltdoc="x">cipher-aead?</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">aes</span><span class="hspace">&nbsp;</span><span class="RktVal">ctr</span><span class="RktVal">)</span><span class="RktPn">)</span></td></tr><tr><td><p><span class="RktRes">#f</span></p></td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._cipher-aead~3f%29%29" class="RktValLink" data-pltdoc="x">cipher-aead?</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">aes</span><span class="hspace">&nbsp;</span><span class="RktVal">gcm</span><span class="RktVal">)</span><span class="RktPn">)</span></td></tr><tr><td><p><span class="RktRes">#t</span></p></td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._cipher-aead~3f%29%29" class="RktValLink" data-pltdoc="x">cipher-aead?</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">chacha20-poly1305</span><span class="hspace">&nbsp;</span><span class="RktVal">stream</span><span class="RktVal">)</span><span class="RktPn">)</span></td></tr><tr><td><p><span class="RktRes">#t</span></p></td></tr></table></blockquote></div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._crypto/main..rkt)._cipher-default-auth-size))"></a><span title="Provided from: crypto | Package: crypto-lib"><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._cipher-default-auth-size%29%29" class="RktValDef RktValLink" data-pltdoc="x">cipher-default-auth-size</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">ci</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/number-types.html#%28def._%28%28quote._~23~25kernel%29._exact-nonnegative-integer~3f%29%29" class="RktValLink" data-pltdoc="x">exact-nonnegative-integer?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">ci</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/data-structure-contracts.html#%28def._%28%28lib._racket%2Fcontract%2Fbase..rkt%29._or%2Fc%29%29" class="RktValLink" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._cipher-spec~3f%29%29" class="RktValLink" data-pltdoc="x">cipher-spec?</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._cipher-impl~3f%29%29" class="RktValLink" data-pltdoc="x">cipher-impl?</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._cipher-ctx~3f%29%29" class="RktValLink" data-pltdoc="x">cipher-ctx?</a></span><span class="RktPn">)</span></td></tr></table></blockquote></div><div class="SIntrapara">Returns the default size in bytes of the <a href="#%28tech._authentication._tag%29" class="techoutside" data-pltdoc="x"><span class="techinside">authentication tag</span></a>
produced by <span class="RktVar">ci</span> if it represents an <a href="#%28tech._authenticated._encryption%29" class="techoutside" data-pltdoc="x"><span class="techinside">authenticated encryption or decryption</span></a> algorithm;
<span class="RktVal">0</span> otherwise.</div></p><p><div class="SIntrapara">Examples:</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._cipher-default-auth-size%29%29" class="RktValLink" data-pltdoc="x">cipher-default-auth-size</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">aes</span><span class="hspace">&nbsp;</span><span class="RktVal">gcm</span><span class="RktVal">)</span><span class="RktPn">)</span></td></tr><tr><td><p><span class="RktRes">16</span></p></td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._cipher-default-auth-size%29%29" class="RktValLink" data-pltdoc="x">cipher-default-auth-size</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">aes</span><span class="hspace">&nbsp;</span><span class="RktVal">ctr</span><span class="RktVal">)</span><span class="RktPn">)</span></td></tr><tr><td><p><span class="RktRes">0</span></p></td></tr></table></blockquote></div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><table cellspacing="0" cellpadding="0" class="together"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._crypto/main..rkt)._generate-cipher-key))"></a><span title="Provided from: crypto | Package: crypto-lib"><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._generate-cipher-key%29%29" class="RktValDef RktValLink" data-pltdoc="x">generate-cipher-key</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">ci</span><span class="hspace">&nbsp;</span>[<span class="RktPn">#:size</span><span class="hspace">&nbsp;</span><span class="RktVar">size</span>]<span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/bytestrings.html#%28def._%28%28quote._~23~25kernel%29._bytes~3f%29%29" class="RktValLink" data-pltdoc="x">bytes?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">ci</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/data-structure-contracts.html#%28def._%28%28lib._racket%2Fcontract%2Fbase..rkt%29._or%2Fc%29%29" class="RktValLink" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._cipher-spec~3f%29%29" class="RktValLink" data-pltdoc="x">cipher-spec?</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._cipher-impl~3f%29%29" class="RktValLink" data-pltdoc="x">cipher-impl?</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">size</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/number-types.html#%28def._%28%28quote._~23~25kernel%29._exact-positive-integer~3f%29%29" class="RktValLink" data-pltdoc="x">exact-positive-integer?</a></span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._cipher-default-key-size%29%29" class="RktValLink" data-pltdoc="x">cipher-default-key-size</a></span><span class="hspace">&nbsp;</span><span class="RktVar">ci</span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="together"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._crypto/main..rkt)._generate-cipher-iv))"></a><span title="Provided from: crypto | Package: crypto-lib"><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._generate-cipher-iv%29%29" class="RktValDef RktValLink" data-pltdoc="x">generate-cipher-iv</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">ci</span><span class="hspace">&nbsp;</span>[<span class="RktPn">#:size</span><span class="hspace">&nbsp;</span><span class="RktVar">size</span>]<span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/bytestrings.html#%28def._%28%28quote._~23~25kernel%29._bytes~3f%29%29" class="RktValLink" data-pltdoc="x">bytes?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">ci</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/data-structure-contracts.html#%28def._%28%28lib._racket%2Fcontract%2Fbase..rkt%29._or%2Fc%29%29" class="RktValLink" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._cipher-spec~3f%29%29" class="RktValLink" data-pltdoc="x">cipher-spec?</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._cipher-impl~3f%29%29" class="RktValLink" data-pltdoc="x">cipher-impl?</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">size</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/number-types.html#%28def._%28%28quote._~23~25kernel%29._exact-positive-integer~3f%29%29" class="RktValLink" data-pltdoc="x">exact-positive-integer?</a></span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._cipher-iv-size%29%29" class="RktValLink" data-pltdoc="x">cipher-iv-size</a></span><span class="hspace">&nbsp;</span><span class="RktVar">ci</span><span class="RktPn">)</span></td></tr></table></td></tr></table></blockquote></div><div class="SIntrapara">Generates a random secret key or initialization vector, respectively,
appropriate for use with the cipher <span class="RktVar">ci</span>. Some ciphers have a
set of weak keys; <span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._generate-cipher-key%29%29" class="RktValLink" data-pltdoc="x">generate-cipher-key</a></span> currently does
<span style="font-style: italic">not</span> detect or avoid weak keys. If <span class="RktVar">ci</span> does not use an
IV, <span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._generate-cipher-iv%29%29" class="RktValLink" data-pltdoc="x">generate-cipher-iv</a></span> returns <span class="RktVal">#f</span>.</div></p><p>The random bytes are generated with <span class="RktSym"><a href="misc.html#%28def._%28%28lib._crypto%2Fmain..rkt%29._crypto-random-bytes%29%29" class="RktValLink" data-pltdoc="x">crypto-random-bytes</a></span>.</p><h4>4.1<tt>&nbsp;</tt><a name="(part._.High-level_.Cipher_.Operations)"></a>High-level Cipher Operations</h4><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><table cellspacing="0" cellpadding="0" class="together"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><table cellspacing="0" cellpadding="0" class="prototype RForeground"><tr><td valign="top"><span class="RktPn">(</span><a name="(def._((lib._crypto/main..rkt)._encrypt))"></a><span title="Provided from: crypto | Package: crypto-lib"><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._encrypt%29%29" class="RktValDef RktValLink" data-pltdoc="x">encrypt</a></span></span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVar">ci</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVar">key</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVar">iv</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVar">input</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span>[</td><td valign="top"><span class="RktPn">#:aad</span><span class="hspace">&nbsp;</span><span class="RktVar">additional-authenticated-data</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">#:auth-size</span><span class="hspace">&nbsp;</span><span class="RktVar">auth-size</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">#:pad</span><span class="hspace">&nbsp;</span><span class="RktVar">pad-mode</span>]<span class="RktPn">)</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top">&rarr;</td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktSym"><a href="http://docs.racket-lang.org/reference/bytestrings.html#%28def._%28%28quote._~23~25kernel%29._bytes~3f%29%29" class="RktValLink" data-pltdoc="x">bytes?</a></span></td></tr></table></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">ci</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/data-structure-contracts.html#%28def._%28%28lib._racket%2Fcontract%2Fbase..rkt%29._or%2Fc%29%29" class="RktValLink" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._cipher-spec~3f%29%29" class="RktValLink" data-pltdoc="x">cipher-spec?</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._cipher-impl~3f%29%29" class="RktValLink" data-pltdoc="x">cipher-impl?</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">key</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/bytestrings.html#%28def._%28%28quote._~23~25kernel%29._bytes~3f%29%29" class="RktValLink" data-pltdoc="x">bytes?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">iv</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/data-structure-contracts.html#%28def._%28%28lib._racket%2Fcontract%2Fbase..rkt%29._or%2Fc%29%29" class="RktValLink" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/bytestrings.html#%28def._%28%28quote._~23~25kernel%29._bytes~3f%29%29" class="RktValLink" data-pltdoc="x">bytes?</a></span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">input</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="misc.html#%28def._%28%28lib._crypto%2Fmain..rkt%29._input%2Fc%29%29" class="RktValLink" data-pltdoc="x">input/c</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">additional-authenticated-data</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="misc.html#%28def._%28%28lib._crypto%2Fmain..rkt%29._input%2Fc%29%29" class="RktValLink" data-pltdoc="x">input/c</a></span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktVal">#""</span></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="argcontract"><tr><td valign="top"><span class="hspace">&nbsp;&nbsp;</span></td><td valign="top"><span class="RktVar">auth-size</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top">:</td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktSym"><a href="http://docs.racket-lang.org/reference/number-types.html#%28def._%28%28quote._~23~25kernel%29._exact-nonnegative-integer~3f%29%29" class="RktValLink" data-pltdoc="x">exact-nonnegative-integer?</a></span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top">=</td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._cipher-default-auth-size%29%29" class="RktValLink" data-pltdoc="x">cipher-default-auth-size</a></span><span class="hspace">&nbsp;</span><span class="RktVar">ci</span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">pad-mode</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/booleans.html#%28def._%28%28quote._~23~25kernel%29._boolean~3f%29%29" class="RktValLink" data-pltdoc="x">boolean?</a></span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktVal">#t</span></td></tr></table></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="together"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><table cellspacing="0" cellpadding="0" class="prototype RForeground"><tr><td valign="top"><span class="RktPn">(</span><a name="(def._((lib._crypto/main..rkt)._decrypt))"></a><span title="Provided from: crypto | Package: crypto-lib"><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._decrypt%29%29" class="RktValDef RktValLink" data-pltdoc="x">decrypt</a></span></span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVar">ci</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVar">key</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVar">iv</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVar">input</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span>[</td><td valign="top"><span class="RktPn">#:aad</span><span class="hspace">&nbsp;</span><span class="RktVar">additional-authenticated-data</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">#:auth-size</span><span class="hspace">&nbsp;</span><span class="RktVar">auth-size</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">#:pad</span><span class="hspace">&nbsp;</span><span class="RktVar">pad-mode</span>]<span class="RktPn">)</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top">&rarr;</td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktSym"><a href="http://docs.racket-lang.org/reference/bytestrings.html#%28def._%28%28quote._~23~25kernel%29._bytes~3f%29%29" class="RktValLink" data-pltdoc="x">bytes?</a></span></td></tr></table></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">ci</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/data-structure-contracts.html#%28def._%28%28lib._racket%2Fcontract%2Fbase..rkt%29._or%2Fc%29%29" class="RktValLink" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._cipher-spec~3f%29%29" class="RktValLink" data-pltdoc="x">cipher-spec?</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._cipher-impl~3f%29%29" class="RktValLink" data-pltdoc="x">cipher-impl?</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">key</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/bytestrings.html#%28def._%28%28quote._~23~25kernel%29._bytes~3f%29%29" class="RktValLink" data-pltdoc="x">bytes?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">iv</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/data-structure-contracts.html#%28def._%28%28lib._racket%2Fcontract%2Fbase..rkt%29._or%2Fc%29%29" class="RktValLink" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/bytestrings.html#%28def._%28%28quote._~23~25kernel%29._bytes~3f%29%29" class="RktValLink" data-pltdoc="x">bytes?</a></span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">input</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/data-structure-contracts.html#%28def._%28%28lib._racket%2Fcontract%2Fbase..rkt%29._or%2Fc%29%29" class="RktValLink" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/bytestrings.html#%28def._%28%28quote._~23~25kernel%29._bytes~3f%29%29" class="RktValLink" data-pltdoc="x">bytes?</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/port-ops.html#%28def._%28%28quote._~23~25kernel%29._input-port~3f%29%29" class="RktValLink" data-pltdoc="x">input-port?</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">additional-authenticated-data</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="misc.html#%28def._%28%28lib._crypto%2Fmain..rkt%29._input%2Fc%29%29" class="RktValLink" data-pltdoc="x">input/c</a></span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktVal">#""</span></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="argcontract"><tr><td valign="top"><span class="hspace">&nbsp;&nbsp;</span></td><td valign="top"><span class="RktVar">auth-size</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top">:</td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktSym"><a href="http://docs.racket-lang.org/reference/number-types.html#%28def._%28%28quote._~23~25kernel%29._exact-nonnegative-integer~3f%29%29" class="RktValLink" data-pltdoc="x">exact-nonnegative-integer?</a></span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top">=</td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._cipher-default-auth-size%29%29" class="RktValLink" data-pltdoc="x">cipher-default-auth-size</a></span><span class="hspace">&nbsp;</span><span class="RktVar">ci</span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">pad-mode</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/booleans.html#%28def._%28%28quote._~23~25kernel%29._boolean~3f%29%29" class="RktValLink" data-pltdoc="x">boolean?</a></span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktVal">#t</span></td></tr></table></td></tr></table></blockquote></div><div class="SIntrapara">Encrypt or decrypt, respectively, using the secret <span class="RktVar">key</span>,
<a href="#%28tech._initialization._vector%29" class="techoutside" data-pltdoc="x"><span class="techinside">initialization vector</span></a> <span class="RktVar">iv</span>, and padding mode
<span class="RktVar">pad-mode</span>.  See <span class="RktSym"><a href="misc.html#%28def._%28%28lib._crypto%2Fmain..rkt%29._input%2Fc%29%29" class="RktValLink" data-pltdoc="x">input/c</a></span> for accepted values of
<span class="RktVar">input</span> and <span class="RktVar">additional-authenticated-data</span> and the
rules of their conversion to bytes.</div></p><p>If <span class="RktVar">ci</span> is a block cipher and if <span class="RktVar">pad-mode</span> is
<span class="RktVal">#t</span>, then the input is padded using PKCS#7 padding during
encryption, and the padding is checked and removed during decryption;
otherwise if <span class="RktVar">pad-mode</span> is <span class="RktVal">#f</span>, then the input is not
padded, and its length must by divisible by <span class="RktVar">ci</span>&rsquo;s block
size. If <span class="RktVar">ci</span> is a stream cipher (including block ciphers using
a stream mode), <span class="RktSym">pad</span> is ignored and no padding is
added. Future versions of this library may support additional kinds of
padding.</p><p>If <span class="RktVar">ci</span> is an <a href="#%28tech._authenticated._encryption%29" class="techoutside" data-pltdoc="x"><span class="techinside">authenticated encryption</span></a> (AEAD) cipher,
the <a href="#%28tech._authentication._tag%29" class="techoutside" data-pltdoc="x"><span class="techinside">authentication tag</span></a> it produces is <span style="font-style: italic">attached</span> to the
ciphertext. That is, <span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._encrypt%29%29" class="RktValLink" data-pltdoc="x">encrypt</a></span> appends the authentication tag
to the end of the ciphertext, and <span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._decrypt%29%29" class="RktValLink" data-pltdoc="x">decrypt</a></span> extracts the
authentication tag from the end of the ciphertext. The
<span class="RktVar">auth-size</span> argument controls the length of the authentication
tag. If authenticated decryption fails, an exception is raised.</p><p><div class="SIntrapara">Examples:</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/define.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktVar">key</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._generate-cipher-key%29%29" class="RktValLink" data-pltdoc="x">generate-cipher-key</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">aes</span><span class="hspace">&nbsp;</span><span class="RktVal">ctr</span><span class="RktVal">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/define.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktVar">iv</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._generate-cipher-iv%29%29" class="RktValLink" data-pltdoc="x">generate-cipher-iv</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">aes</span><span class="hspace">&nbsp;</span><span class="RktVal">ctr</span><span class="RktVal">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/define.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">ciphertext</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._encrypt%29%29" class="RktValLink" data-pltdoc="x">encrypt</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">aes</span><span class="hspace">&nbsp;</span><span class="RktVal">ctr</span><span class="RktVal">)</span><span class="hspace">&nbsp;</span><span class="RktVar">key</span><span class="hspace">&nbsp;</span><span class="RktVar">iv</span><span class="hspace">&nbsp;</span><span class="RktVal">"Hello world!"</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="stt">&gt; </span><span class="RktSym">ciphertext</span></td></tr><tr><td><p><span class="RktRes">#"\331 &gt;\303\0\370\240Mf\177\345\204"</span></p></td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._decrypt%29%29" class="RktValLink" data-pltdoc="x">decrypt</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">aes</span><span class="hspace">&nbsp;</span><span class="RktVal">ctr</span><span class="RktVal">)</span><span class="hspace">&nbsp;</span><span class="RktVar">key</span><span class="hspace">&nbsp;</span><span class="RktVar">iv</span><span class="hspace">&nbsp;</span><span class="RktSym">ciphertext</span><span class="RktPn">)</span></td></tr><tr><td><p><span class="RktRes">#"Hello world!"</span></p></td></tr></table></blockquote></div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><table cellspacing="0" cellpadding="0" class="together"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><table cellspacing="0" cellpadding="0" class="prototype RForeground"><tr><td valign="top"><span class="RktPn">(</span><a name="(def._((lib._crypto/main..rkt)._encrypt/auth))"></a><span title="Provided from: crypto | Package: crypto-lib"><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._encrypt%2Fauth%29%29" class="RktValDef RktValLink" data-pltdoc="x">encrypt/auth</a></span></span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVar">ci</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVar">key</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVar">iv</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVar">input</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span>[</td><td valign="top"><span class="RktPn">#:aad</span><span class="hspace">&nbsp;</span><span class="RktVar">additional-authenticated-data</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">#:auth-size</span><span class="hspace">&nbsp;</span><span class="RktVar">auth-size</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">#:pad</span><span class="hspace">&nbsp;</span><span class="RktVar">pad-mode</span>]<span class="RktPn">)</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr></table></blockquote></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="prototype"><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top">&rarr;</td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><table cellspacing="0" cellpadding="0"><tr><td><span class="RktSym"><a href="http://docs.racket-lang.org/reference/bytestrings.html#%28def._%28%28quote._~23~25kernel%29._bytes~3f%29%29" class="RktValLink" data-pltdoc="x">bytes?</a></span></td><td><span class="hspace">&nbsp;</span></td><td><span class="RktSym"><a href="http://docs.racket-lang.org/reference/bytestrings.html#%28def._%28%28quote._~23~25kernel%29._bytes~3f%29%29" class="RktValLink" data-pltdoc="x">bytes?</a></span></td></tr></table></td></tr></table></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">ci</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/data-structure-contracts.html#%28def._%28%28lib._racket%2Fcontract%2Fbase..rkt%29._or%2Fc%29%29" class="RktValLink" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._cipher-spec~3f%29%29" class="RktValLink" data-pltdoc="x">cipher-spec?</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._cipher-impl~3f%29%29" class="RktValLink" data-pltdoc="x">cipher-impl?</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">key</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/bytestrings.html#%28def._%28%28quote._~23~25kernel%29._bytes~3f%29%29" class="RktValLink" data-pltdoc="x">bytes?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">iv</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/data-structure-contracts.html#%28def._%28%28lib._racket%2Fcontract%2Fbase..rkt%29._or%2Fc%29%29" class="RktValLink" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/bytestrings.html#%28def._%28%28quote._~23~25kernel%29._bytes~3f%29%29" class="RktValLink" data-pltdoc="x">bytes?</a></span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">input</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="misc.html#%28def._%28%28lib._crypto%2Fmain..rkt%29._input%2Fc%29%29" class="RktValLink" data-pltdoc="x">input/c</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">additional-authenticated-data</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="misc.html#%28def._%28%28lib._crypto%2Fmain..rkt%29._input%2Fc%29%29" class="RktValLink" data-pltdoc="x">input/c</a></span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktVal">#""</span></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="argcontract"><tr><td valign="top"><span class="hspace">&nbsp;&nbsp;</span></td><td valign="top"><span class="RktVar">auth-size</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top">:</td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktSym"><a href="http://docs.racket-lang.org/reference/number-types.html#%28def._%28%28quote._~23~25kernel%29._exact-nonnegative-integer~3f%29%29" class="RktValLink" data-pltdoc="x">exact-nonnegative-integer?</a></span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top">=</td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._cipher-default-auth-size%29%29" class="RktValLink" data-pltdoc="x">cipher-default-auth-size</a></span><span class="hspace">&nbsp;</span><span class="RktVar">ci</span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">pad-mode</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/booleans.html#%28def._%28%28quote._~23~25kernel%29._boolean~3f%29%29" class="RktValLink" data-pltdoc="x">boolean?</a></span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktVal">#t</span></td></tr></table></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="together"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><table cellspacing="0" cellpadding="0" class="prototype RForeground"><tr><td valign="top"><span class="RktPn">(</span><a name="(def._((lib._crypto/main..rkt)._decrypt/auth))"></a><span title="Provided from: crypto | Package: crypto-lib"><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._decrypt%2Fauth%29%29" class="RktValDef RktValLink" data-pltdoc="x">decrypt/auth</a></span></span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVar">ci</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVar">key</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVar">iv</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVar">input</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span>[</td><td valign="top"><span class="RktPn">#:aad</span><span class="hspace">&nbsp;</span><span class="RktVar">additional-authenticated-data</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">#:auth-tag</span><span class="hspace">&nbsp;</span><span class="RktVar">auth-tag</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">#:pad</span><span class="hspace">&nbsp;</span><span class="RktVar">pad-mode</span>]<span class="RktPn">)</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top">&rarr;</td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktSym"><a href="http://docs.racket-lang.org/reference/bytestrings.html#%28def._%28%28quote._~23~25kernel%29._bytes~3f%29%29" class="RktValLink" data-pltdoc="x">bytes?</a></span></td></tr></table></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">ci</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/data-structure-contracts.html#%28def._%28%28lib._racket%2Fcontract%2Fbase..rkt%29._or%2Fc%29%29" class="RktValLink" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._cipher-spec~3f%29%29" class="RktValLink" data-pltdoc="x">cipher-spec?</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._cipher-impl~3f%29%29" class="RktValLink" data-pltdoc="x">cipher-impl?</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">key</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/bytestrings.html#%28def._%28%28quote._~23~25kernel%29._bytes~3f%29%29" class="RktValLink" data-pltdoc="x">bytes?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">iv</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/data-structure-contracts.html#%28def._%28%28lib._racket%2Fcontract%2Fbase..rkt%29._or%2Fc%29%29" class="RktValLink" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/bytestrings.html#%28def._%28%28quote._~23~25kernel%29._bytes~3f%29%29" class="RktValLink" data-pltdoc="x">bytes?</a></span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">input</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/data-structure-contracts.html#%28def._%28%28lib._racket%2Fcontract%2Fbase..rkt%29._or%2Fc%29%29" class="RktValLink" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/bytestrings.html#%28def._%28%28quote._~23~25kernel%29._bytes~3f%29%29" class="RktValLink" data-pltdoc="x">bytes?</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/port-ops.html#%28def._%28%28quote._~23~25kernel%29._input-port~3f%29%29" class="RktValLink" data-pltdoc="x">input-port?</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">additional-authenticated-data</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="misc.html#%28def._%28%28lib._crypto%2Fmain..rkt%29._input%2Fc%29%29" class="RktValLink" data-pltdoc="x">input/c</a></span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktVal">#""</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">auth-tag</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/bytestrings.html#%28def._%28%28quote._~23~25kernel%29._bytes~3f%29%29" class="RktValLink" data-pltdoc="x">bytes?</a></span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktVal">#""</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">pad-mode</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/booleans.html#%28def._%28%28quote._~23~25kernel%29._boolean~3f%29%29" class="RktValLink" data-pltdoc="x">boolean?</a></span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktVal">#t</span></td></tr></table></td></tr></table></blockquote></div><div class="SIntrapara">Like <span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._encrypt%29%29" class="RktValLink" data-pltdoc="x">encrypt</a></span> and <span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._decrypt%29%29" class="RktValLink" data-pltdoc="x">decrypt</a></span>, respectively, but the
authentication tag is <span style="font-style: italic">detached</span> from the ciphertext. That is,
<span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._encrypt%2Fauth%29%29" class="RktValLink" data-pltdoc="x">encrypt/auth</a></span> produces two values consisting of the ciphertext
and authentication tag, and <span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._decrypt%2Fauth%29%29" class="RktValLink" data-pltdoc="x">decrypt/auth</a></span> takes the ciphertext
and authentication tag as distinct arguments.</div></p><p>If <span class="RktVar">ci</span> is not an AEAD cipher, the authentication tag is always
<span class="RktVal">#""</span>.</p><p><div class="SIntrapara">Examples:</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/define.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktVar">key</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._generate-cipher-key%29%29" class="RktValLink" data-pltdoc="x">generate-cipher-key</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">aes</span><span class="hspace">&nbsp;</span><span class="RktVal">gcm</span><span class="RktVal">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/define.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktVar">iv</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._generate-cipher-iv%29%29" class="RktValLink" data-pltdoc="x">generate-cipher-iv</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">aes</span><span class="hspace">&nbsp;</span><span class="RktVal">gcm</span><span class="RktVal">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/define.html#%28form._%28%28quote._~23~25kernel%29._define-values%29%29" class="RktStxLink" data-pltdoc="x">define-values</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">ciphertext</span><span class="hspace">&nbsp;</span><span class="RktVar">auth-tag</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._encrypt%2Fauth%29%29" class="RktValLink" data-pltdoc="x">encrypt/auth</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">aes</span><span class="hspace">&nbsp;</span><span class="RktVal">gcm</span><span class="RktVal">)</span><span class="hspace">&nbsp;</span><span class="RktVar">key</span><span class="hspace">&nbsp;</span><span class="RktVar">iv</span><span class="hspace">&nbsp;</span><span class="RktVal">"Hello world!"</span><span class="hspace">&nbsp;</span><span class="RktPn">#:aad</span><span class="hspace">&nbsp;</span><span class="RktVal">#"greeting"</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._decrypt%2Fauth%29%29" class="RktValLink" data-pltdoc="x">decrypt/auth</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">aes</span><span class="hspace">&nbsp;</span><span class="RktVal">gcm</span><span class="RktVal">)</span><span class="hspace">&nbsp;</span><span class="RktVar">key</span><span class="hspace">&nbsp;</span><span class="RktVar">iv</span><span class="hspace">&nbsp;</span><span class="RktSym">ciphertext</span><span class="hspace">&nbsp;</span><span class="RktPn">#:aad</span><span class="hspace">&nbsp;</span><span class="RktVal">#"greeting"</span><span class="hspace">&nbsp;</span><span class="RktPn">#:auth-tag</span><span class="hspace">&nbsp;</span><span class="RktVar">auth-tag</span><span class="RktPn">)</span></td></tr><tr><td><p><span class="RktRes">#"Hello world!"</span></p></td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._decrypt%2Fauth%29%29" class="RktValLink" data-pltdoc="x">decrypt/auth</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">aes</span><span class="hspace">&nbsp;</span><span class="RktVal">gcm</span><span class="RktVal">)</span><span class="hspace">&nbsp;</span><span class="RktVar">key</span><span class="hspace">&nbsp;</span><span class="RktVar">iv</span><span class="hspace">&nbsp;</span><span class="RktSym">ciphertext</span><span class="hspace">&nbsp;</span><span class="RktPn">#:aad</span><span class="hspace">&nbsp;</span><span class="RktVal">#"INVALID"</span><span class="hspace">&nbsp;</span><span class="RktPn">#:auth-tag</span><span class="hspace">&nbsp;</span><span class="RktVar">auth-tag</span><span class="RktPn">)</span></td></tr><tr><td><p><span class="RktErr">decrypt: authenticated decryption failed</span></p></td></tr></table></blockquote></div></p><h4>4.2<tt>&nbsp;</tt><a name="(part._.Low-level_.Cipher_.Operations)"></a>Low-level Cipher Operations</h4><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><table cellspacing="0" cellpadding="0" class="together"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><table cellspacing="0" cellpadding="0" class="prototype RForeground"><tr><td valign="top"><span class="RktPn">(</span><a name="(def._((lib._crypto/main..rkt)._make-encrypt-ctx))"></a><span title="Provided from: crypto | Package: crypto-lib"><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._make-encrypt-ctx%29%29" class="RktValDef RktValLink" data-pltdoc="x">make-encrypt-ctx</a></span></span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVar">ci</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVar">key</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVar">iv</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span>[</td><td valign="top"><span class="RktPn">#:auth-size</span><span class="hspace">&nbsp;</span><span class="RktVar">auth-size</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">#:auth-attached?</span><span class="hspace">&nbsp;</span><span class="RktVar">auth-attached?</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">#:pad</span><span class="hspace">&nbsp;</span><span class="RktVar">pad-mode</span>]<span class="RktPn">)</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr></table></blockquote></td></tr><tr><td><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._encrypt-ctx~3f%29%29" class="RktValLink" data-pltdoc="x">encrypt-ctx?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">ci</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/data-structure-contracts.html#%28def._%28%28lib._racket%2Fcontract%2Fbase..rkt%29._or%2Fc%29%29" class="RktValLink" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._cipher-spec~3f%29%29" class="RktValLink" data-pltdoc="x">cipher-spec?</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._cipher-impl~3f%29%29" class="RktValLink" data-pltdoc="x">cipher-impl?</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">key</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/bytestrings.html#%28def._%28%28quote._~23~25kernel%29._bytes~3f%29%29" class="RktValLink" data-pltdoc="x">bytes?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">iv</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/data-structure-contracts.html#%28def._%28%28lib._racket%2Fcontract%2Fbase..rkt%29._or%2Fc%29%29" class="RktValLink" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/bytestrings.html#%28def._%28%28quote._~23~25kernel%29._bytes~3f%29%29" class="RktValLink" data-pltdoc="x">bytes?</a></span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="RktPn">)</span></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="argcontract"><tr><td valign="top"><span class="hspace">&nbsp;&nbsp;</span></td><td valign="top"><span class="RktVar">auth-size</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top">:</td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktSym"><a href="http://docs.racket-lang.org/reference/number-types.html#%28def._%28%28quote._~23~25kernel%29._exact-nonnegative-integer~3f%29%29" class="RktValLink" data-pltdoc="x">exact-nonnegative-integer?</a></span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top">=</td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._cipher-default-auth-size%29%29" class="RktValLink" data-pltdoc="x">cipher-default-auth-size</a></span><span class="hspace">&nbsp;</span><span class="RktVar">ci</span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">auth-attached?</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/booleans.html#%28def._%28%28quote._~23~25kernel%29._boolean~3f%29%29" class="RktValLink" data-pltdoc="x">boolean?</a></span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktVal">#t</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">pad-mode</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/booleans.html#%28def._%28%28quote._~23~25kernel%29._boolean~3f%29%29" class="RktValLink" data-pltdoc="x">boolean?</a></span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktVal">#t</span></td></tr></table></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="together"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><table cellspacing="0" cellpadding="0" class="prototype RForeground"><tr><td valign="top"><span class="RktPn">(</span><a name="(def._((lib._crypto/main..rkt)._make-decrypt-ctx))"></a><span title="Provided from: crypto | Package: crypto-lib"><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._make-decrypt-ctx%29%29" class="RktValDef RktValLink" data-pltdoc="x">make-decrypt-ctx</a></span></span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVar">ci</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVar">key</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVar">iv</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span>[</td><td valign="top"><span class="RktPn">#:auth-size</span><span class="hspace">&nbsp;</span><span class="RktVar">auth-size</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">#:auth-attached?</span><span class="hspace">&nbsp;</span><span class="RktVar">auth-attached?</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">#:pad</span><span class="hspace">&nbsp;</span><span class="RktVar">pad-mode</span>]<span class="RktPn">)</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr></table></blockquote></td></tr><tr><td><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._decrypt-ctx~3f%29%29" class="RktValLink" data-pltdoc="x">decrypt-ctx?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">ci</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/data-structure-contracts.html#%28def._%28%28lib._racket%2Fcontract%2Fbase..rkt%29._or%2Fc%29%29" class="RktValLink" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._cipher-spec~3f%29%29" class="RktValLink" data-pltdoc="x">cipher-spec?</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._cipher-impl~3f%29%29" class="RktValLink" data-pltdoc="x">cipher-impl?</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">key</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/bytestrings.html#%28def._%28%28quote._~23~25kernel%29._bytes~3f%29%29" class="RktValLink" data-pltdoc="x">bytes?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">iv</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/data-structure-contracts.html#%28def._%28%28lib._racket%2Fcontract%2Fbase..rkt%29._or%2Fc%29%29" class="RktValLink" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/bytestrings.html#%28def._%28%28quote._~23~25kernel%29._bytes~3f%29%29" class="RktValLink" data-pltdoc="x">bytes?</a></span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="RktPn">)</span></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="argcontract"><tr><td valign="top"><span class="hspace">&nbsp;&nbsp;</span></td><td valign="top"><span class="RktVar">auth-size</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top">:</td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktSym"><a href="http://docs.racket-lang.org/reference/number-types.html#%28def._%28%28quote._~23~25kernel%29._exact-nonnegative-integer~3f%29%29" class="RktValLink" data-pltdoc="x">exact-nonnegative-integer?</a></span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top">=</td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._cipher-default-auth-size%29%29" class="RktValLink" data-pltdoc="x">cipher-default-auth-size</a></span><span class="hspace">&nbsp;</span><span class="RktVar">ci</span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">auth-attached?</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/booleans.html#%28def._%28%28quote._~23~25kernel%29._boolean~3f%29%29" class="RktValLink" data-pltdoc="x">boolean?</a></span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktVal">#t</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">pad-mode</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/booleans.html#%28def._%28%28quote._~23~25kernel%29._boolean~3f%29%29" class="RktValLink" data-pltdoc="x">boolean?</a></span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktVal">#t</span></td></tr></table></td></tr></table></blockquote></div><div class="SIntrapara">Returns a new cipher context for encryption or decryption,
respectively, using the given secret <span class="RktVar">key</span>, initialization
vector <span class="RktVar">iv</span>, and padding mode <span class="RktVar">pad-mode</span>.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._crypto/main..rkt)._cipher-ctx~3f))"></a><span title="Provided from: crypto | Package: crypto-lib"><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._cipher-ctx~3f%29%29" class="RktValDef RktValLink" data-pltdoc="x">cipher-ctx?</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">v</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/booleans.html#%28def._%28%28quote._~23~25kernel%29._boolean~3f%29%29" class="RktValLink" data-pltdoc="x">boolean?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">v</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/data-structure-contracts.html#%28def._%28%28lib._racket%2Fcontract%2Fprivate%2Fmisc..rkt%29._any%2Fc%29%29" class="RktValLink" data-pltdoc="x">any/c</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Returns <span class="RktVal">#t</span> if <span class="RktVar">v</span> is a cipher context, <span class="RktVal">#f</span>
otherwise.</div></p><p>Equivalent to <span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/if.html#%28form._%28%28lib._racket%2Fprivate%2Fletstx-scheme..rkt%29._or%29%29" class="RktStxLink" data-pltdoc="x">or</a></span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._encrypt-ctx~3f%29%29" class="RktValLink" data-pltdoc="x">encrypt-ctx?</a></span><span class="stt"> </span><span class="RktVar">v</span><span class="RktPn">)</span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._decrypt-ctx~3f%29%29" class="RktValLink" data-pltdoc="x">decrypt-ctx?</a></span><span class="stt"> </span><span class="RktVar">v</span><span class="RktPn">)</span><span class="RktPn">)</span>.</p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><table cellspacing="0" cellpadding="0" class="together"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._crypto/main..rkt)._encrypt-ctx~3f))"></a><span title="Provided from: crypto | Package: crypto-lib"><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._encrypt-ctx~3f%29%29" class="RktValDef RktValLink" data-pltdoc="x">encrypt-ctx?</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">v</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/booleans.html#%28def._%28%28quote._~23~25kernel%29._boolean~3f%29%29" class="RktValLink" data-pltdoc="x">boolean?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">v</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/data-structure-contracts.html#%28def._%28%28lib._racket%2Fcontract%2Fprivate%2Fmisc..rkt%29._any%2Fc%29%29" class="RktValLink" data-pltdoc="x">any/c</a></span></td></tr></table></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="together"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._crypto/main..rkt)._decrypt-ctx~3f))"></a><span title="Provided from: crypto | Package: crypto-lib"><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._decrypt-ctx~3f%29%29" class="RktValDef RktValLink" data-pltdoc="x">decrypt-ctx?</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">v</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/booleans.html#%28def._%28%28quote._~23~25kernel%29._boolean~3f%29%29" class="RktValLink" data-pltdoc="x">boolean?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">v</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/data-structure-contracts.html#%28def._%28%28lib._racket%2Fcontract%2Fprivate%2Fmisc..rkt%29._any%2Fc%29%29" class="RktValLink" data-pltdoc="x">any/c</a></span></td></tr></table></td></tr></table></blockquote></div><div class="SIntrapara">Returns <span class="RktVal">#t</span> if <span class="RktVar">v</span> is a cipher context for encryption
or decryption, respectively; otherwise, returns <span class="RktVal">#f</span>.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._crypto/main..rkt)._cipher-update))"></a><span title="Provided from: crypto | Package: crypto-lib"><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._cipher-update%29%29" class="RktValDef RktValLink" data-pltdoc="x">cipher-update</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">cctx</span><span class="hspace">&nbsp;</span><span class="RktVar">input</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/bytestrings.html#%28def._%28%28quote._~23~25kernel%29._bytes~3f%29%29" class="RktValLink" data-pltdoc="x">bytes?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">cctx</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._cipher-ctx~3f%29%29" class="RktValLink" data-pltdoc="x">cipher-ctx?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">input</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="misc.html#%28def._%28%28lib._crypto%2Fmain..rkt%29._input%2Fc%29%29" class="RktValLink" data-pltdoc="x">input/c</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Processes <span class="RktVar">input</span> with the cipher context <span class="RktVar">cctx</span>,
returning the newly available encrypted or decrypted output. The
output may be larger or smaller than the input, because incomplete
blocks are internally buffered by <span class="RktVar">cctx</span>.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._crypto/main..rkt)._cipher-update-aad))"></a><span title="Provided from: crypto | Package: crypto-lib"><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._cipher-update-aad%29%29" class="RktValDef RktValLink" data-pltdoc="x">cipher-update-aad</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">cctx</span><span class="hspace">&nbsp;</span><span class="RktVar">input</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/void.html#%28def._%28%28quote._~23~25kernel%29._void~3f%29%29" class="RktValLink" data-pltdoc="x">void?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">cctx</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._cipher-ctx~3f%29%29" class="RktValLink" data-pltdoc="x">cipher-ctx?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">input</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="misc.html#%28def._%28%28lib._crypto%2Fmain..rkt%29._input%2Fc%29%29" class="RktValLink" data-pltdoc="x">input/c</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Processes <span class="RktVar">input</span> as additional authenticated data to the
cipher context <span class="RktVar">cctx</span>. Must be called before any calls to
<span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._cipher-update%29%29" class="RktValLink" data-pltdoc="x">cipher-update</a></span>.</div></p><p>If <span class="RktVar">cctx</span> is not a context for <a href="#%28tech._authenticated._encryption%29" class="techoutside" data-pltdoc="x"><span class="techinside">authenticated encryption or decryption</span></a>, an exception is
raised.</p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._crypto/main..rkt)._cipher-final))"></a><span title="Provided from: crypto | Package: crypto-lib"><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._cipher-final%29%29" class="RktValDef RktValLink" data-pltdoc="x">cipher-final</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">cctx</span><span class="hspace">&nbsp;</span>[<span class="RktVar">auth-tag</span>]<span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/bytestrings.html#%28def._%28%28quote._~23~25kernel%29._bytes~3f%29%29" class="RktValLink" data-pltdoc="x">bytes?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">cctx</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._cipher-ctx~3f%29%29" class="RktValLink" data-pltdoc="x">cipher-ctx?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">auth-tag</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/data-structure-contracts.html#%28def._%28%28lib._racket%2Fcontract%2Fbase..rkt%29._or%2Fc%29%29" class="RktValLink" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/bytestrings.html#%28def._%28%28quote._~23~25kernel%29._bytes~3f%29%29" class="RktValLink" data-pltdoc="x">bytes?</a></span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktVal">#f</span></td></tr></table></blockquote></div><div class="SIntrapara">Processes any remaining input buffered by <span class="RktVar">cctx</span>, applies or
checks and removes padding if appropriate, and returns the newly
available output.</div></p><p>If <span class="RktVar">cctx</span> is an <a href="#%28tech._authenticated._encryption%29" class="techoutside" data-pltdoc="x"><span class="techinside">authenticated decryption</span></a> context in <span style="font-style: italic">detached</span> mode (that is,
created with <span class="RktPn">#:auth-attached?</span><span class="stt"> </span><span class="RktVal">#f</span>), then <span class="RktVar">auth-tag</span> is
checked against the decryption&rsquo;s final <a href="#%28tech._authentication._tag%29" class="techoutside" data-pltdoc="x"><span class="techinside">authentication tag</span></a> and
an exception is raised if they do not match.</p><p>Otherwise&#8212;<wbr></wbr>if the <span class="RktVar">cctx</span> is an encryption context, or a
decryption context for a non-AEAD cipher, or a decryption context for
an AEAD cipher in <span style="font-style: italic">attached</span> mode&#8212;<wbr></wbr><span class="RktVar">auth-tag</span> must be
<span class="RktVal">#f</span> or else an exception is raised.</p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._crypto/main..rkt)._cipher-get-auth-tag))"></a><span title="Provided from: crypto | Package: crypto-lib"><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._cipher-get-auth-tag%29%29" class="RktValDef RktValLink" data-pltdoc="x">cipher-get-auth-tag</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">cctx</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/bytestrings.html#%28def._%28%28quote._~23~25kernel%29._bytes~3f%29%29" class="RktValLink" data-pltdoc="x">bytes?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">cctx</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._cipher-ctx~3f%29%29" class="RktValLink" data-pltdoc="x">cipher-ctx?</a></span></td></tr></table></blockquote></div><div class="SIntrapara">If <span class="RktVar">cctx</span> is an encryption context, retrieves the
authentication code. For a non-AEAD cipher, the authentication code is
always <span class="RktVal">#""</span>. If called before <span class="RktSym"><a href="#%28def._%28%28lib._crypto%2Fmain..rkt%29._cipher-final%29%29" class="RktValLink" data-pltdoc="x">cipher-final</a></span>, an
exception is raised.</div></p><div class="navsetbottom"><span class="navleft"><div class="nosearchform"></div>&nbsp;&nbsp;</span><span class="navright">&nbsp;&nbsp;<a href="digest.html" title="backward to &quot;3 Message Digests&quot;" data-pltdoc="x">&larr; prev</a>&nbsp;&nbsp;<a href="index.html" title="up to &quot;Crypto: Cryptographic Operations&quot;" data-pltdoc="x">up</a>&nbsp;&nbsp;<a href="pk.html" title="forward to &quot;5 Public-Key Cryptography&quot;" data-pltdoc="x">next &rarr;</a></span>&nbsp;</div></div></div><div id="contextindicator">&nbsp;</div></body></html>